{% extends 'base.html.twig' %}

{% block title %}{{board_name}} - Board{% endblock %}

{% block body %}
<style>
    .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
    .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
</style>

<a href="{{path('boards')}}">Boards list</a>
{% if board_notAllowed == true %}
    <p>You are not allowed to access this board</p>
{% else %}
<div class="example-wrapper">
    
    <h4>Board</h4>
    <h1>{{board_name}}</h1>

    <textarea id="board_content">{{board_content}}</textarea>
    <script>
        $("#board_content").on("input", function() {
            let content = $(this).val();
            let urlStr = "{{path('boards_write', {id: board_id, userid: user_id, text: 'textareaval'})}}";
            urlStr = urlStr.replace("textareaval", content);

            $.ajax({
                url: urlStr,
                method: "POST",
                cache: false
            })
            .done(function(json) {
                
            });
        });
    </script>

    {% if board_isOwner== true %}
    <h2>Board Settings</h2>
        <input type="checkbox" name="setting_private"><label for="setting_private">Set private</label>
        <input type="text" name="addAllowedUser" placeholder="Enter an email to add to allow list"><button id="btnAddAllow">Add</button>
        <div>
            <ul style="height:100px; overflow: auto;">
            </ul>
        </div>

        <script>
            $("#btnAddAllow").on("click", function() {
                let newEmail = $("input[name=addAllowedUser]").val();
                let urlStr = "{{path('boards_email_allow', {id: board_id, email: 'newEmail'})}}";
                urlStr = urlStr.replace("newEmail", newEmail);

                $.ajax({
                    url: urlStr,
                    method: "POST",
                    cache: false,
                })
                .done(function(json) {
                    alert(json.email);
                })
                .fail(function(xhr) {
                    
                });

            });
        </script>
    {% endif %}
    
</div>
{% endif %}


{% endblock %}
